(window["webpackJsonpPluginssik-metro-light"]=window["webpackJsonpPluginssik-metro-light"]||[]).push([[967],{852:function(){},967:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return r}}),i(113);let{Mixin:n}=Shopware,{moveItem:s,object:{cloneDeep:a}}=Shopware.Utils,l=Shopware.Data.Criteria;var r={template:'<div class="sw-cms-el-config-image-gallery">\n    <sw-select-field\n        v-model:value="element.config.galleryPosition.value"\n        :label="$tc(\'sw-cms.elements.imageGallery.config.label.navigationPreview\')"\n    >\n        <option value="left">\n            left\n        </option>\n        <option value="right">\n            right\n        </option>\n    </sw-select-field>\n\n    <sw-switch-field\n        v-model:value="element.config.magnifierOverGallery.value"\n        bordered\n        :label="$tc(\'sw-cms.elements.imageGallery.config.label.magnifierOverGallery\')"\n        :help-text="$tc(\'sw-cms.elements.imageGallery.config.label.magnifierOverGalleryHelpText\')"\n    />\n\n    <sw-switch-field\n        v-model:value="element.config.fullScreen.value"\n        bordered\n        :label="$tc(\'sw-cms.elements.imageGallery.config.label.fullscreen\')"\n    />\n</div>',inject:["repositoryFactory","feature"],mixins:[n.getByName("cms-element")],data(){return{mediaModalIsOpen:!1,initialFolderId:null,entity:this.element,mediaItems:[],columnWidth:"100px"}},computed:{mediaRepository(){return this.repositoryFactory.create("media")},uploadTag(){return`cms-element-media-config-${this.element.id}`},defaultFolderName(){return this.cmsPageState._entityName},sliderItems(){return this.element.data&&this.element.data.sliderItems&&this.element.data.sliderItems.length>0?this.element.data.sliderItems:[]},sliderItemsConfigValue(){return this.element?.config?.sliderItems?.value},gridAutoRows(){return`grid-auto-rows: ${this.columnWidth}`},isProductPage(){return(this.cmsPageState?.currentPage?.type??"")==="product_detail"}},watch:{sliderItems(){this.updateColumnWidth()},sliderItemsConfigValue(e){if(!e){this.element.config.sliderItems.value=[];return}let t=this.element?.config?.sliderItems?.source==="mapped",i=e&&e.length===this.sliderItems.length;t||i||!this.sliderItems.length||(this.mediaItems=this.sliderItems.map(e=>e.media),this.element.config.sliderItems.value=this.sliderItems.map(e=>({mediaId:e.media.id,mediaUrl:e.media.url,newTab:e.newTab,url:e.url})))}},created(){this.createdComponent()},mounted(){this.mountedComponent()},methods:{async createdComponent(){this.initElementConfig("ssik-metro-product-images");let{source:e,value:t}=this.element.config.sliderItems;if("static"===e&&t&&t.length>0){let e=t.map(e=>e.mediaId),i=new l(1,25);i.setIds(e);let n=await this.mediaRepository.search(i);this.mediaItems=e.map(e=>n.get(e))}this.initConfig()},mountedComponent(){this.updateColumnWidth()},initConfig(){!this.isProductPage||this.element?.translated?.config||this.element?.data?.sliderItems||(this.element.config.sliderItems.source="mapped",this.element.config.sliderItems.value="product.media",this.element.config.navigationDots.value="inside",this.element.config.zoom.value=!0,this.element.config.fullScreen.value=!0,this.element.config.keepAspectRatioOnZoom.value=!0,this.element.config.magnifierOverGallery.value=!0,this.element.config.displayMode.value="contain",this.element.config.minHeight.value="430px")},updateColumnWidth(){this.$refs.demoMediaGrid&&this.$nextTick(()=>{let e=window.getComputedStyle(this.$refs.demoMediaGrid,null).getPropertyValue("grid-template-columns").split(" ");this.columnWidth=e[0]})},onOpenMediaModal(){this.mediaModalIsOpen=!0},onCloseMediaModal(){this.mediaModalIsOpen=!1},onImageUpload(e){let t=this.element.config.sliderItems;"default"===t.source&&(t.value=[],t.source="static",this.mediaItems=[]),this.mediaItems.find(t=>t.id===e.id)&&(this.mediaItems=this.mediaItems.filter(t=>t.id!==e.id),t.value=t.value.filter(t=>t.mediaId!==e.id)),t.value.push({mediaUrl:e.url,mediaId:e.id,url:null,newTab:!1}),this.mediaItems.push(e),this.updateMediaDataValue(),this.emitUpdateEl()},onItemRemove(e,t){let i=e.id;this.element.config.sliderItems.value=this.element.config.sliderItems.value.filter((e,n)=>e.mediaId!==i||n!==t),this.mediaItems=this.mediaItems.filter((e,n)=>e.id!==i||n!==t),this.updateMediaDataValue(),this.emitUpdateEl()},onMediaSelectionChange(e){let t=this.element.config.sliderItems;"default"===t.source&&(t.value=[],t.source="static",this.mediaItems=[]),e.forEach(e=>{this.element.config.sliderItems.value.push({mediaUrl:e.url,mediaId:e.id,url:null,newTab:!1})}),this.mediaItems.push(...e),this.updateMediaDataValue(),this.emitUpdateEl()},updateMediaDataValue(){if(this.element.config.sliderItems.value){let e=a(this.element.config.sliderItems.value);e.forEach(e=>{this.mediaItems.forEach(t=>{e.mediaId===t.id&&(e.media=t)})}),this.element.data?this.$set(this.element.data,"sliderItems",e):this.$set(this.element,"data",{sliderItems:e})}},onItemSort(e,t){s(this.mediaItems,e.position,t.position),s(this.element.config.sliderItems.value,e.position,t.position),this.updateMediaDataValue(),this.emitUpdateEl()},onChangeMinHeight(e){this.element.config.minHeight.value=null===e?"":e,this.$emit("element-update",this.element)},onChangeDisplayMode(e){["cover","contain"].includes(e)&&(this.element.config.verticalAlign.value=null),this.$emit("element-update",this.element)},emitUpdateEl(){this.$emit("element-update",this.element)}}}},113:function(e,t,i){var n=i(852);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals),i(346).Z("5632588f",n,!0,{})},346:function(e,t,i){"use strict";function n(e,t){for(var i=[],n={},s=0;s<t.length;s++){var a=t[s],l=a[0],r={id:e+":"+s,css:a[1],media:a[2],sourceMap:a[3]};n[l]?n[l].parts.push(r):i.push(n[l]={id:l,parts:[r]})}return i}i.d(t,{Z:function(){return f}});var s="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!s)throw Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var a={},l=s&&(document.head||document.getElementsByTagName("head")[0]),r=null,d=0,o=!1,m=function(){},u=null,h="data-vue-ssr-id",c="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(e,t,i,s){o=i,u=s||{};var l=n(e,t);return p(l),function(t){for(var i=[],s=0;s<l.length;s++){var r=a[l[s].id];r.refs--,i.push(r)}t?p(l=n(e,t)):l=[];for(var s=0;s<i.length;s++){var r=i[s];if(0===r.refs){for(var d=0;d<r.parts.length;d++)r.parts[d]();delete a[r.id]}}}}function p(e){for(var t=0;t<e.length;t++){var i=e[t],n=a[i.id];if(n){n.refs++;for(var s=0;s<n.parts.length;s++)n.parts[s](i.parts[s]);for(;s<i.parts.length;s++)n.parts.push(v(i.parts[s]));n.parts.length>i.parts.length&&(n.parts.length=i.parts.length)}else{for(var l=[],s=0;s<i.parts.length;s++)l.push(v(i.parts[s]));a[i.id]={id:i.id,refs:1,parts:l}}}}function g(){var e=document.createElement("style");return e.type="text/css",l.appendChild(e),e}function v(e){var t,i,n=document.querySelector("style["+h+'~="'+e.id+'"]');if(n){if(o)return m;n.parentNode.removeChild(n)}if(c){var s=d++;t=y.bind(null,n=r||(r=g()),s,!1),i=y.bind(null,n,s,!0)}else t=w.bind(null,n=g()),i=function(){n.parentNode.removeChild(n)};return t(e),function(n){n?(n.css!==e.css||n.media!==e.media||n.sourceMap!==e.sourceMap)&&t(e=n):i()}}var I=function(){var e=[];return function(t,i){return e[t]=i,e.filter(Boolean).join("\n")}}();function y(e,t,i,n){var s=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=I(t,s);else{var a=document.createTextNode(s),l=e.childNodes;l[t]&&e.removeChild(l[t]),l.length?e.insertBefore(a,l[t]):e.appendChild(a)}}function w(e,t){var i=t.css,n=t.media,s=t.sourceMap;if(n&&e.setAttribute("media",n),u.ssrId&&e.setAttribute(h,t.id),s&&(i+="\n/*# sourceURL="+s.sources[0]+" */\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}}}]);